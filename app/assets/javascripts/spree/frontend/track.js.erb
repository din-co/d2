// track is the preferred way to send events to both KM and Intercom.
function track(args) {
  <% unless TRUE_PRODUCTION_INSTANCE %>
    console.log('Track: ' + JSON.stringify(args));
  <% end %>
  trackKissmetrics(args);
  trackIntercom(args);
}

function trackKissmetrics(args) {
  _kmq.push(['record', args.name, args.metadata]);
}

function trackIntercom(args) {
  $(function() {
  	Intercom('trackEvent', args.name, args.metadata);
  });
}
