<% if @meal_preference.present? && @meal_preference.errors.any? %>
  <div id="error_explanation">
    <h2>
      <%= pluralize(@meal_preference.errors.count, "error") %> prohibited
      this from being saved:
    </h2>
    <ul>
      <% @meal_preference.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
    </ul>
  </div>
<% end %>

<div class="row">
  <div class="col-sm-6">
    <h3>I enjoy meals with:</h3>
    <div class="checkbox"><label><%= f.check_box :diet_beef, checked: (@meal_preference.presence.try(:diet_beef).nil? ? true : @meal_preference.presence.try(:diet_beef)) %> beef</label></div>
    <div class="checkbox"><label><%= f.check_box :diet_lamb, checked: (@meal_preference.presence.try(:diet_lamb).nil? ? true : @meal_preference.presence.try(:diet_lamb)) %> lamb</label></div>
    <div class="checkbox"><label><%= f.check_box :diet_pork, checked: (@meal_preference.presence.try(:diet_pork).nil? ? true : @meal_preference.presence.try(:diet_pork)) %> pork</label></div>
    <div class="checkbox"><label><%= f.check_box :diet_poultry, checked: (@meal_preference.presence.try(:diet_poultry).nil? ? true : @meal_preference.presence.try(:diet_poultry)) %> poultry</label></div>
    <div class="checkbox"><label><%= f.check_box :diet_rabbit, checked: (@meal_preference.presence.try(:diet_rabbit).nil? ? true : @meal_preference.presence.try(:diet_rabbit)) %> rabbit</label></div>
    <div class="checkbox"><label><%= f.check_box :diet_fish, checked: (@meal_preference.presence.try(:diet_fish).nil? ? true : @meal_preference.presence.try(:diet_fish)) %> fish</label></div>
    <div class="checkbox"><label><%= f.check_box :diet_seafood, checked: (@meal_preference.presence.try(:diet_seafood).nil? ? true : @meal_preference.presence.try(:diet_seafood)) %> seafood</label></div>
    <div class="checkbox"><label><%= f.check_box :diet_tofu, checked: (@meal_preference.presence.try(:diet_tofu).nil? ? true : @meal_preference.presence.try(:diet_tofu)) %> tofu</label></div>
    <div class="checkbox"><label><%= f.check_box :diet_tempeh, checked: (@meal_preference.presence.try(:diet_tempeh).nil? ? true : @meal_preference.presence.try(:diet_tempeh)) %> tempeh</label></div>
  </div>
  <div class="col-sm-6">
    <h3>I canâ€™t eat these foods:</h3>
    <div class="checkbox"><label><%= f.check_box :allergen_none, checked: (@meal_preference.presence.try(:allergen_none).nil? ? true : @meal_preference.presence.try(:allergen_none)) %> none</label></div>
    <div class="checkbox"><label><%= f.check_box :allergen_eggs, checked: (@meal_preference.presence.try(:allergen_eggs).nil? ? false : @meal_preference.presence.try(:allergen_eggs)) %> eggs</label></div>
    <div class="checkbox"><label><%= f.check_box :allergen_fish, checked: (@meal_preference.presence.try(:allergen_fish).nil? ? false : @meal_preference.presence.try(:allergen_fish)) %> fish</label></div>
    <div class="checkbox"><label><%= f.check_box :allergen_milk, checked: (@meal_preference.presence.try(:allergen_milk).nil? ? false : @meal_preference.presence.try(:allergen_milk)) %> milk</label></div>
    <div class="checkbox"><label><%= f.check_box :allergen_peanuts, checked: (@meal_preference.presence.try(:allergen_peanuts).nil? ? false : @meal_preference.presence.try(:allergen_peanuts)) %> peanuts</label></div>
    <div class="checkbox"><label><%= f.check_box :allergen_shellfish, checked: (@meal_preference.presence.try(:allergen_shellfish).nil? ? false : @meal_preference.presence.try(:allergen_shellfish)) %> shellfish</label></div>
    <div class="checkbox"><label><%= f.check_box :allergen_soybeans, checked: (@meal_preference.presence.try(:allergen_soybeans).nil? ? false : @meal_preference.presence.try(:allergen_soybeans)) %> soybeans</label></div>
    <div class="checkbox"><label><%= f.check_box :allergen_tree_nuts, checked: (@meal_preference.presence.try(:allergen_tree_nuts).nil? ? false : @meal_preference.presence.try(:allergen_tree_nuts)) %> tree nuts</label></div>
    <div class="checkbox"><label><%= f.check_box :allergen_wheat_gluten, checked: (@meal_preference.presence.try(:allergen_wheat_gluten).nil? ? false : @meal_preference.presence.try(:allergen_wheat_gluten)) %> wheat/gluten</label></div>
  </div>
</div>

<p>
  <%= f.submit "Save Meal Preferences", :class => 'btn btn-primary' %>
</p>

<script type="text/javascript">
$(function(){
  var allergens = $("[name^='meal_preference[allergen']")
  var noAllergens = $("#meal_preference_allergen_none")
  allergens.click(function(){
    if ($(this).is(noAllergens) && $(this)[0].checked) {
      allergens.not(noAllergens).prop({checked: false});
    } else {
      noAllergens.prop({checked: false});
    }
  })
})
</script>
